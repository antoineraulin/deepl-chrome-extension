var port=chrome.runtime.connect({name:"deepl"}),all=document.getElementsByTagName("*"),i=0,y=0,bigSentence="",bigArr=[];function get(){if(console.log("tagName => "+all[i].tagName),"P"==all[i].tagName||"H1"==all[i].tagName||"H3"==all[i].tagName||"H4"==all[i].tagName||"H2"==all[i].tagName||"H2"==all[i].tagName||"TITLE"==all[i].tagName||"A"==all[i].tagName||"EM"==all[i].tagName||"CITE"==all[i].tagName){var e=all[i].innerHTML;console.log(e),"A"==all[i].tagName&&(e.indexOf("<svg")>-1||e.indexOf("<img")>-1||e.indexOf("<source")||e.indexOf("<picture"))?(i+=1,get()):e.length>400?(bigSentence="",y=0,bigArr=[],multiTranslate((bigArr=e.split("."))[y])):translate(e)}else i+=1,get()}function translate(e){port.postMessage({i:i,data:e,type:"single"})}function multiTranslate(e){port.postMessage({i:y,data:e,type:"multi"})}port.onMessage.addListener(function(e){console.log(e),"single"==e.type&&"deepl"==e.to?1!=e.error?(console.log("trad => "+e.result),all[i].innerHTML=e.result,(i=e.i)<all.length?get():(console.log("finished"),port.postMessage({msg:"finished"}))):(console.error("erreur durant la traduction."),i=e.i,get(),i<all.length?get():(console.log("finished"),port.postMessage({msg:"finished"}))):"multi"==e.type&&"deepl"==e.to&&(1!=e.error?(bigSentence+=e.result+". ",(y=e.i)<bigArr.length?multiTranslate(bigArr[y]):(all[i].innerHTML=bigSentence,i++,get())):(console.error("erreur durant la traduction."),(y=e.i)<bigArr.length?multiTranslate(bigArr[y]):(all[i].innerHTML=bigSentence,i+=1,get())))}),get();